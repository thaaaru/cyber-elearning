import React, { useState, useEffect } from 'react';
import { 
  Network, 
  Cpu, 
  Globe, 
  Terminal, 
  ShieldCheck, 
  Scale, 
  ChevronDown, 
  ChevronUp,
  Home,
  Key,
  Utensils,
  Bot,
  Lock,
  FileText,
  Menu,
  X
} from 'lucide-react';

const CourseModule = ({ title, icon: Icon, color, children, id }) => (
  <section id={id} className="mb-16 scroll-mt-24 animate-fadeIn">
    <div className={`flex items-center gap-4 mb-6 pb-4 border-b border-slate-700`}>
      <div className={`p-3 rounded-xl ${color} bg-opacity-20`}>
        <Icon className={`w-8 h-8 ${color.replace('bg-', 'text-')}`} />
      </div>
      <h2 className="text-3xl font-bold text-white">{title}</h2>
    </div>
    <div className="grid gap-8">
      {children}
    </div>
  </section>
);

const ConceptCard = ({ term, analogyTitle, analogyText, mechanicsTitle, mechanicsText, icon: Icon }) => {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <div className="bg-slate-800 border border-slate-700 rounded-xl overflow-hidden hover:border-cyan-500/50 transition-all duration-300 shadow-lg">
      {/* Header / Term */}
      <div className="bg-slate-900/50 p-6 border-b border-slate-700 flex justify-between items-start">
        <div>
          <span className="text-cyan-400 text-sm font-mono uppercase tracking-wider">The Technical Term</span>
          <h3 className="text-2xl font-bold text-white mt-1">{term}</h3>
        </div>
        <div className="p-2 bg-slate-800 rounded-lg">
          <Icon className="w-6 h-6 text-slate-400" />
        </div>
      </div>

      {/* Analogy Section (Always Visible) */}
      <div className="p-6 bg-slate-800">
        <div className="flex items-start gap-4">
          <div className="mt-1">
            <div className="bg-purple-500/20 p-2 rounded-lg">
              <span className="text-2xl">ðŸ’¡</span>
            </div>
          </div>
          <div>
            <span className="text-purple-400 text-sm font-bold uppercase tracking-wide">The Translation</span>
            <h4 className="text-lg font-semibold text-slate-200 mt-1">{analogyTitle}</h4>
            <p className="text-slate-400 mt-2 leading-relaxed">{analogyText}</p>
          </div>
        </div>
      </div>

      {/* Mechanics Section (Collapsible) */}
      <div className="border-t border-slate-700">
        <button 
          onClick={() => setIsOpen(!isOpen)}
          className="w-full flex items-center justify-between p-4 text-slate-400 hover:text-white hover:bg-slate-700/50 transition-colors text-sm font-medium"
        >
          <span>{isOpen ? "Hide Technical Details" : "Reveal How It Actually Works"}</span>
          {isOpen ? <ChevronUp className="w-4 h-4" /> : <ChevronDown className="w-4 h-4" />}
        </button>
        
        {isOpen && (
          <div className="p-6 bg-slate-900/80 border-t border-slate-700 animate-slideDown">
            <span className="text-green-400 text-xs font-bold uppercase tracking-wide flex items-center gap-2">
              <Terminal className="w-3 h-3" /> The Mechanics
            </span>
            <h4 className="text-md font-semibold text-slate-200 mt-2">{mechanicsTitle}</h4>
            <div className="text-slate-400 mt-2 space-y-2 text-sm leading-relaxed font-mono">
              {mechanicsText}
            </div>
          </div>
        )}
      </div>
    </div>
  );
};

const NavBar = ({ activeSection, scrollToSection, isMobileMenuOpen, setIsMobileMenuOpen }) => {
  const navItems = [
    { id: 'intro', label: 'Start' },
    { id: 'mod1', label: 'Networking' },
    { id: 'mod2', label: 'OS' },
    { id: 'mod3', label: 'Web' },
    { id: 'mod4', label: 'Scripting' },
    { id: 'mod5', label: 'Security' },
    { id: 'mod6', label: 'Ethics' },
  ];

  return (
    <nav className="fixed top-0 left-0 right-0 bg-slate-900/90 backdrop-blur-md border-b border-slate-800 z-50">
      <div className="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
        <div className="flex items-center gap-2 font-bold text-xl text-white">
          <ShieldCheck className="text-cyan-400" />
          <span>Hack<span className="text-cyan-400">/</span>Build</span>
        </div>

        {/* Desktop Nav */}
        <div className="hidden md:flex gap-1">
          {navItems.map((item) => (
            <button
              key={item.id}
              onClick={() => scrollToSection(item.id)}
              className={`px-4 py-2 rounded-lg text-sm font-medium transition-all ${
                activeSection === item.id 
                  ? 'bg-cyan-500/10 text-cyan-400' 
                  : 'text-slate-400 hover:text-white hover:bg-slate-800'
              }`}
            >
              {item.label}
            </button>
          ))}
        </div>

        {/* Mobile Menu Button */}
        <button 
          className="md:hidden text-white"
          onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
        >
          {isMobileMenuOpen ? <X /> : <Menu />}
        </button>
      </div>

      {/* Mobile Nav */}
      {isMobileMenuOpen && (
        <div className="md:hidden bg-slate-900 border-b border-slate-800 p-4">
          <div className="flex flex-col gap-2">
            {navItems.map((item) => (
              <button
                key={item.id}
                onClick={() => {
                  scrollToSection(item.id);
                  setIsMobileMenuOpen(false);
                }}
                className="px-4 py-3 rounded-lg text-left text-sm font-medium text-slate-300 hover:bg-slate-800"
              >
                {item.label}
              </button>
            ))}
          </div>
        </div>
      )}
    </nav>
  );
};

const App = () => {
  const [activeSection, setActiveSection] = useState('intro');
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

  const scrollToSection = (id) => {
    const element = document.getElementById(id);
    if (element) {
      element.scrollIntoView({ behavior: 'smooth' });
      setActiveSection(id);
    }
  };

  return (
    <div className="min-h-screen bg-slate-950 text-slate-300 font-sans selection:bg-cyan-500/30">
      <NavBar 
        activeSection={activeSection} 
        scrollToSection={scrollToSection} 
        isMobileMenuOpen={isMobileMenuOpen}
        setIsMobileMenuOpen={setIsMobileMenuOpen}
      />

      <main className="max-w-4xl mx-auto px-4 pt-24 pb-20">
        
        {/* Intro Header */}
        <section id="intro" className="text-center py-16 mb-12 border-b border-slate-800">
          <h1 className="text-4xl md:text-6xl font-extrabold text-white mb-6 tracking-tight">
            Ethical Hacking <br />
            <span className="text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 to-purple-500">
              Demystified
            </span>
          </h1>
          <p className="text-lg text-slate-400 max-w-2xl mx-auto mb-8">
            A jargon-free guide to understanding how computers talk, listen, and keep secrets. 
            Designed for non-technical beginners.
          </p>
          <div className="flex justify-center gap-4">
            <button 
              onClick={() => scrollToSection('mod1')}
              className="px-8 py-3 bg-cyan-500 hover:bg-cyan-400 text-slate-950 font-bold rounded-lg transition-all transform hover:-translate-y-1 shadow-lg shadow-cyan-500/20"
            >
              Start Learning
            </button>
          </div>
        </section>

        {/* Module 1: Networking */}
        <CourseModule title="Module 1: Networking" icon={Network} color="bg-blue-500" id="mod1">
          <ConceptCard 
            term="IP Address"
            icon={Home}
            analogyTitle="The House Address"
            analogyText="Imagine the internet is a giant city. Every computer is a house. For the mailman (the internet) to deliver a letter (data) to your house, you need a unique address."
            mechanicsTitle="DHCP & IPv4/IPv6"
            mechanicsText={
              <>
                <p>â€¢ <strong>DHCP:</strong> When you join Wi-Fi, the Router acts like a landlord assigning you a temporary apartment number.</p>
                <p>â€¢ <strong>IPv4:</strong> Old style (192.168.1.1). We ran out of these.</p>
                <p>â€¢ <strong>IPv6:</strong> New style. Complex and infinite. Like giving every grain of sand a phone number.</p>
              </>
            }
          />
          <ConceptCard 
            term="DNS"
            icon={Globe}
            analogyTitle="The Phonebook"
            analogyText="You don't memorize your friend's phone number; you tap their name in your contacts. You type 'google.com', but the computer needs the actual number."
            mechanicsTitle="DNS Resolution & Spoofing"
            mechanicsText={
              <>
                <p>â€¢ <strong>Resolution:</strong> Your computer secretly asks a DNS Server: 'What is the number for Google?' It replies '142.250.190.46'.</p>
                <p>â€¢ <strong>The Hack:</strong> DNS Spoofing is like hacking the phonebook. You type 'Mom', but the phone calls the scammer.</p>
              </>
            }
          />
          <ConceptCard 
            term="Port"
            icon={Home}
            analogyTitle="The Doors & Windows"
            analogyText="The mail arrives at the house (IP), but where does it go? The Living Room (Web), the Boiler Room (Admin), or the Mailbox (Email)?"
            mechanicsTitle="TCP/UDP Ports"
            mechanicsText={
              <>
                <p>â€¢ <strong>Port 80/443:</strong> Web Traffic (The Front Door).</p>
                <p>â€¢ <strong>Port 22:</strong> SSH/Admin (The Locked Back Door).</p>
                <p>â€¢ <strong>Scanning:</strong> Hackers knock on every door to see which one is unlocked.</p>
              </>
            }
          />
        </CourseModule>

        {/* Module 2: OS */}
        <CourseModule title="Module 2: Operating Systems" icon={Cpu} color="bg-indigo-500" id="mod2">
          <ConceptCard 
            term="The Kernel"
            icon={Cpu}
            analogyTitle="The Subconscious Brain"
            analogyText="You (the user) don't tell your heart to beat. You just think 'Run', and the brain handles the muscles. The Kernel is that brain."
            mechanicsTitle="Hardware Interaction"
            mechanicsText="The Kernel talks directly to the hardware (CPU, RAM). If a hacker compromises the Kernel, they control the 'reality' of that machine."
          />
          <ConceptCard 
            term="File Permissions"
            icon={Key}
            analogyTitle="The Key Ring"
            analogyText="In a hotel, your key opens one room. The Manager's key opens EVERY room. We want the Manager's key."
            mechanicsTitle="Read, Write, Execute (rwx)"
            mechanicsText={
              <>
                <p>â€¢ <strong>777 Permission:</strong> Everyone can Read, Write, and Execute. This is dangerous.</p>
                <p>â€¢ <strong>Privilege Escalation:</strong> Starting as a Guest and finding a flaw that lets you become Admin (Root).</p>
              </>
            }
          />
        </CourseModule>

        {/* Module 3: Web */}
        <CourseModule title="Module 3: Web Technologies" icon={Globe} color="bg-cyan-500" id="mod3">
          <ConceptCard 
            term="Client-Server"
            icon={Utensils}
            analogyTitle="The Restaurant"
            analogyText="You (Client) are the customer. The Server is the Kitchen. You order food, but you don't see how it's cooked."
            mechanicsTitle="Request & Response"
            mechanicsText="You send an HTTP Request (The Order Ticket). The Server processes it and sends back HTML (The Food). Hackers mess with the ticket before it reaches the kitchen."
          />
          <ConceptCard 
            term="Cookies"
            icon={FileText}
            analogyTitle="The Table Number"
            analogyText="The Kitchen is busy. They forget you instantly. To remember you, they give you a plastic number stand (Cookie)."
            mechanicsTitle="Session Hijacking"
            mechanicsText="If I steal your table number and put it on my table, the waiter brings YOUR food to ME. I become you without needing your password."
          />
        </CourseModule>

        {/* Module 4: Scripting */}
        <CourseModule title="Module 4: Scripting" icon={Terminal} color="bg-green-500" id="mod4">
          <ConceptCard 
            term="Automation"
            icon={Bot}
            analogyTitle="The Robot Butler"
            analogyText="Manual hacking is like washing dishes by hand. Scripting is building a dishwasher to do it for you while you sleep."
            mechanicsTitle="Loops & Variables"
            mechanicsText={
              <>
                <p>â€¢ <strong>Loop:</strong> 'Try password 0000. Did it work? No. Try 0001.' Repeat 10,000 times per second.</p>
                <p>â€¢ <strong>Efficiency:</strong> Humans act in seconds. Scripts act in milliseconds.</p>
              </>
            }
          />
        </CourseModule>

        {/* Module 5: Security */}
        <CourseModule title="Module 5: Security Concepts" icon={Lock} color="bg-red-500" id="mod5">
          <ConceptCard 
            term="Hashing"
            icon={Utensils}
            analogyTitle="The Fruit Smoothie"
            analogyText="You blend a strawberry and banana. You get pink sludge. You CANNOT turn the sludge back into a strawberry."
            mechanicsTitle="One-Way Functions"
            mechanicsText="Banks store the 'sludge' (Hash), not your password. When you login, they blend your input. If the sludge matches, you get in. This protects passwords during a data breach."
          />
          <ConceptCard 
            term="VPN"
            icon={Lock}
            analogyTitle="The Concrete Tunnel"
            analogyText="Imagine walking down a glass hallway. Everyone sees what you are carrying. A VPN builds a concrete tunnel around you inside that hallway."
            mechanicsTitle="Encrypted Tunnels"
            mechanicsText="People on the outside (Internet Service Provider, Hackers on Wi-Fi) can see the tunnel exists, but cannot see the data inside it."
          />
        </CourseModule>

        {/* Module 6: Ethics */}
        <CourseModule title="Module 6: Legal & Ethics" icon={Scale} color="bg-yellow-500" id="mod6">
          <ConceptCard 
            term="White Hat vs Black Hat"
            icon={ShieldCheck}
            analogyTitle="Locksmith vs Burglar"
            analogyText="Both know exactly how to pick the lock. The tools are the same. The ONLY difference is permission."
            mechanicsTitle="Scope of Work"
            mechanicsText="A 'Get Out of Jail Free' card. It is a legal contract signed by the company authorizing you to break in. Without this paper, you are a criminal."
          />
        </CourseModule>

        <footer className="text-center text-slate-500 pt-12 border-t border-slate-800">
          <p>Â© Ethical Hacking Fundamentals. Built for the curious.</p>
        </footer>

      </main>
    </div>
  );
};

export default App;
